!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){var b="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var c,d;c=window||b,c.thinkthroughmath||(c.thinkthroughmath={}),a("./lib"),(d=c.thinkthroughmath).widgets||(d.widgets={}),a("./widgets/ui_elements"),a("./widgets/math_buttons"),a("./widgets/calculator")}).call(this)},{"./lib":2,"./widgets/calculator":16,"./widgets/math_buttons":17,"./widgets/ui_elements":18}],2:[function(a){var b="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=window||b,h=g.thinkthroughmath||(g.thinkthroughmath={}),h.lib||(h.lib={}),i=a("underscore"),a("./lib/class_mixer"),a("./lib/logger"),a("./lib/polyfill"),h.defaults=function(a,b){return i.extend({},b,a)},h.logger||(h.logger=h.Logger.buildProduction({stringify_objects:!1})),h.AP=function(a){var b,c,d;c=""+a.constructor.name,c+="{ ";for(b in a)d=a[b],c+=""+b+": "+d;return c+=" }"},h.dashboard||(h.dashboard={}),h.decorators||(h.decorators={}),f=function(){var a,b;return b=[],a={},a.history=function(){return b},a.update=function(a){return b.push(a)},a.current=function(){return b[b.length-1]},a.updatedo=function(c){return b.push(c(a.current()))},a},h.lib.historic_value={build:f},c=function(){function a(){}return a.prototype.initialize=function(){return this.refinements=[]},a.prototype.forType=function(a,b){return this.refinements.push(d.build(a,b))},a.prototype.forDefault=function(a){return this.default_refinement=e.build(a)},a.prototype.refine=function(a){var b,c,d,e;for(e=this.refinements,c=0,d=e.length;d>c;c++)if(b=e[c],b.isApplicable(a))return b.apply(a);return this.default_refinement?this.default_refinement.apply(a):a},a}(),h.class_mixer(c),e=function(){function a(){}return a.prototype.initialize=function(a){this.methods=a},a.prototype.apply=function(a){var b,c;return b=function(){},b.prototype=a,c=new b,i.extend(c,{unrefined:function(){return a}},this.methods),c},a}(),h.class_mixer(e),d=function(a){function b(){return j=b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.initialize=function(a,b){this.type=a,this.methods=b},b.prototype.isApplicable=function(a){return a instanceof this.type},b}(e),h.class_mixer(d),h.lib.object_refinement=c,a("./lib/math"),i.mixin({compactObject:function(a){return i.each(a,function(b,c){return b?void 0:delete a[c]}),a}})}).call(this)},{"./lib/class_mixer":3,"./lib/logger":4,"./lib/math":5,"./lib/polyfill":15,underscore:19}],3:[function(){(function(){var a;a=thinkthroughmath,a.ClassMixer=a.class_mixer=function(a){return a.build=function(){var b;return b=new a,b.initialize&&b.initialize.apply(b,arguments),b},a.prototype.klass=a,a}}).call(this)},{}],4:[function(a){var b="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a("./class_mixer"),l=window||b,m=l.thinkthroughmath,k=m.class_mixer,d=function(){function a(){}return a.prototype.initialize=function(a,b){this.level=a,this.args=b},a.prototype.createStrMsg=function(){var a,b,c,d,e;for(b="",e=this.args,c=0,d=e.length;d>c;c++)a=e[c],"string"!=typeof a&&(a=JSON.stringify(a)),b+=""+a+" ";return""+this.levelAndEntryIndexString()+" "+b},a.prototype.createArrMsg=function(){var a,b,c,d,e,f;for(c=[],b=this.levelAndEntryIndexString(),f=this.args,d=0,e=f.length;e>d;d++)a=f[d],"string"==typeof a?b+=" "+a:(0!==b.length&&c.push(b),b="",c.push(a));return 0!==b.length&&c.push(b),c},a.prototype.levelAndEntryIndexString=function(){return""+this.level+" (#"+this.index+"):"},a.prototype.display=function(a,b){return this.index=b,a?[this.createStrMsg()]:this.createArrMsg()},a.prototype.match=function(a){return this.createStrMsg().match(a)},a}(),k(d),c=function(){function a(){}return a.prototype.initialize=function(a){this.args=a},a}(),k(c),e=function(){function a(){}return a.prototype.initialize=function(a){return null==a&&(a={}),this.console_log=a.console_log,this.stringify_objects=a.stringify_objects,this.logging_policy=a.logging_policy,this.entries=[],this.unique_id=0},a.prototype.add=function(a,b){var c,e;return null==b&&(b=[]),c=d.build(a,b),this.logging_policy.acceptIncoming(c)?(this.entries.push(c),e=this.entries.length-1,this.console_log.apply(null,c.display(this.stringify_objects,e))):void 0},a.prototype.lookup=function(a){return this.entries[a]},a.prototype.error=function(){return this.add("error",arguments)},a.prototype.warn=function(){return this.add("warn",arguments)},a.prototype.info=function(){return this.add("info",arguments)},a.prototype.debug=function(){return this.add("debug",arguments)},a.prototype.log=function(){return this.add("log",arguments)},a.prototype.getUniqueId=function(){return this.unique_id+=1},a.prototype.instrument=function(a){var b;return b=this,function(){var c,d,e;return d=b.getUniqueId(),c=Array.prototype.slice.call(arguments),c.unshift(this),c.unshift(""+a.name+" call (id "+d+"): "),b.add("instrumented",c),e=a.fn.apply(this,arguments),b.add("instrumented",[""+a.name+" return (id "+d+"): ",e]),e}},a.prototype.logMethodCall=function(a,b,c,d){var e,f;return e=this.getUniqueId(),this.info("method call (id "+e+"): ",a,b,c,d),f=b[c].apply(b,d),this.info("method call return (id "+e+"): ",a,c,d,f),f},a}(),k(e),g=function(){function a(){}return a.prototype.initialize=function(){return this.log_entry_types=["error","warn","info","debug","log","instrumented"],this.log_entry_display_types=this.typesForLevel("production")},a.prototype.typesForLevel=function(a){switch(a){case"production":return["error","warn"];case"firehose":return this.log_entry_types;default:return[]}},a.prototype.logLevelActive=function(a){return-1!==this.log_entry_display_types.indexOf(a)},a}(),k(g),i=function(a){function b(){return n=b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.acceptIncoming=function(){return!1},b}(g),k(i),j=function(a){function b(){return o=b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.acceptIncoming=function(){return!0},b}(g),k(j),h=function(a){function b(){return p=b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.acceptIncoming=function(a){return this.logLevelActive(a.level)},b}(g),k(h),f=function(){function a(){}return a.prototype.build=function(a){return null==a&&(a={}),a=m.defaults(a,{console_log:function(){return"undefined"!=typeof console&&console.log?console.log.apply(console,arguments):void 0},stringify_objects:!0,log_level:"firehose",logging_policy:j.build()}),e.build(a)},a.prototype.buildSilent=function(a){var b;return null==a&&(a={}),b=i.build(),this.build(m.defaults(a,{logging_policy:b}))},a.prototype.buildVerbose=function(a){return this.build(a)},a.prototype.buildProduction=function(a){var b;return null==a&&(a={}),b=h.build(),this.build(m.defaults(a,{logging_policy:b}))},a}(),k(f),thinkthroughmath.Logger=f.build()}).call(this)},{"./class_mixer":3}],5:[function(a){(function(){var b,c,d;c=thinkthroughmath,(d=c.lib).math||(d.math={}),a("./math/precise"),a("./math/expression_components"),a("./math/expression_equality"),a("./math/expression_evaluation"),a("./math/expression_manipulation"),a("./math/expression_position"),a("./math/build_expression_from_javascript_object"),a("./math/expression_traversal"),a("./math/expression_to_string"),b=function(){function a(){}return a.prototype.initialize=function(a){var b,d;return null==a&&(a={}),d=a.precise||c.lib.math.Precise.build(),b=a.comps||c.lib.math.ExpressionComponentSource.build(d),this.components=a.components||b,this.equation=a.equation||b.equation,this.expression=a.expression||b.expression,this.expression_position=a.expression_position||c.lib.math.ExpressionPosition,this.traversal=a.traversal||c.lib.math.ExpressionTraversalBuilder.build(b.classes),this.commands=a.commands||c.lib.math.ExpressionManipulationSource.build(b,this.expression_position,this.traversal),this.object_to_expression=a.object_to_expression||c.lib.math.BuildExpressionFromJavascriptObject.build({component_builder:this.components}),this.evaluation=a.evaluation||c.lib.math.ExpressionEvaluation,this.expression_equality=a.expression_equality||c.lib.math.ExpressionEquality},a}(),c.lib.math.math_lib=c.class_mixer(b)}).call(this)},{"./math/build_expression_from_javascript_object":6,"./math/expression_components":7,"./math/expression_equality":8,"./math/expression_evaluation":9,"./math/expression_manipulation":10,"./math/expression_position":11,"./math/expression_to_string":12,"./math/expression_traversal":13,"./math/precise":14}],6:[function(){(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;f=thinkthroughmath,e=f.logger,c=f.class_mixer,b=function(){function a(){}return a.prototype.initialize=function(a,b){return this.processor=a,this.js_object=b,this.position_val=!1},a.prototype.convert=function(){return this.converted_val=this.processor.convert(this.js_object,this)},a.prototype.converted=function(){return this.converted_val},a.prototype.checkForPosition=function(a,b){return b&&b.has_cursor?this.position_val=a.id():void 0},a.prototype.position=function(){return this.position_val},a}(),c(b),a=function(){function a(){}return a.prototype.initialize=function(a){if(this.opts=null!=a?a:{},this.component_builder=this.opts.component_builder,!this.component_builder)throw"BuildExpressionFromJavascriptObject requires component builder option";return this.processor=o.build(),this.root_converter=l.build(this.processor,this.component_builder),this.number_converter=k.build(this.component_builder),this.exponentiation_converter=h.build(this.processor,this.component_builder),this.fraction_converter=j.build(this.processor,this.component_builder),this.fn_converter=i.build(this.processor,this.component_builder),this.string_literal_converter=m.build(this.component_builder,{"+":"build_addition","-":"build_subtraction","/":"build_division","*":"build_multiplication","=":"build_equals",pi:"build_pi"}),this.closed_expression_converter=g.build(this.component_builder,this.processor),this.variable_converter=n.build(this.processor,this.component_builder),this.processor.converters([this.closed_expression_converter,this.number_converter,this.exponentiation_converter,this.string_literal_converter,this.root_converter,this.variable_converter,this.fraction_converter,this.fn_converter])},a.prototype.process=function(a){var c;return c=b.build(this.processor,a),c.convert(),c},a.prototype.buildExpressionFunction=function(){var a=this;return function(){var b,c;return b=Array.prototype.slice.call(arguments,0),c=a.process(b),c.converted()}},a.prototype.buildExpressionPositionFunction=function(){var a=this;return function(){var b,c;return b=Array.prototype.slice.call(arguments,0),c=a.process(b),c.position()?f.lib.math.ExpressionPosition.build({expression:c.converted(),position:c.position()}):f.lib.math.ExpressionPosition.buildExpressionPositionAsLast(c.converted())}},a}(),c(a),o=function(){function a(){}return a.prototype.converters=function(a){this.js_object_converters=a},a.prototype.convert=function(a,b){var c,d,e,f;for(f=this.js_object_converters,d=0,e=f.length;e>d;d++)if(c=f[d],c.isType(a))return c.convert(a,b);throw"Unhandled js object: "+JSON.stringify(a)},a}(),c(o),g=function(){function a(){}return a.prototype.initialize=function(a,b){this.expression_builder=a,this.processor=b},a.prototype.isType=function(a){return"object"==typeof a&&a instanceof Array},a.prototype.convert=function(a,b){var c,d,e,f,g;for(d=this.expression_builder.build_expression(),f=0,g=a.length;g>f;f++)e=a[f],c=this.processor.convert(e,b),d=d.append(c);return b.checkForPosition(d,a),d},a}(),c(g),k=function(){function a(){}return a.prototype.initialize=function(a){this.number_builder=a},a.prototype.isType=function(a){return this.isJSNumber(a)||this.isStringNumber(a)},a.prototype.isJSNumber=function(a){return"number"==typeof a},a.prototype.isStringNumber=function(a){return"string"==typeof a&&-1!==a.search(/\d+/)},a.prototype.convert=function(a){return this.isJSNumber(a)?this.number_builder.build_number({value:a}):this.isStringNumber(a)?this.numberFromString(a):void 0},a.prototype.numberFromString=function(a){var b;return(b=a.match(/(\d+)(\.)(\d+)/))?this.number_builder.build_number({value:a}):(b=a.match(/(\d+)(\.)/))?this.number_builder.build_number({value:b[1],future_as_decimal:!0}):(b=a.match(/(\d+)/))?this.number_builder.build_number({value:b[1]}):void 0},a}(),c(k),h=function(){function a(){}return a.prototype.initialize=function(a,b){this.processor=a,this.exponentiation_builder=b},a.prototype.isType=function(a){return a["^"]instanceof Array},a.prototype.convert=function(a,b){var c,e,f,g;return e=a["^"][0],g=a["^"][1],c=d(e,this.processor,b),f=d(g,this.processor,b),b.checkForPosition(c,e),b.checkForPosition(f,g),this.exponentiation_builder.build_exponentiation({base:c,power:f})},a}(),c(h),l=function(){function a(){}return a.prototype.initialize=function(a,b){this.processor=a,this.root_builder=b},a.prototype.isType=function(a){return a.root instanceof Array},a.prototype.convert=function(a,b){var c,e;return c=d(a.root[0],this.processor,b),e=d(a.root[1],this.processor,b),this.root_builder.build_root({degree:c,radicand:e})},a}(),c(l),n=function(){function a(){}return a.prototype.initialize=function(a,b){this.processor=a,this.variable_builder=b},a.prototype.isType=function(a){return"string"==typeof a.variable},a.prototype.convert=function(a){return this.variable_builder.build_variable({name:a.variable})},a}(),c(n),j=function(){function a(){}return a.prototype.initialize=function(a,b){this.processor=a,this.fraction_builder=b},a.prototype.isType=function(a){return a.fraction instanceof Array},a.prototype.convert=function(a,b){var c,e,f,g;return f=a.fraction[0],g=d(f,this.processor,b),c=a.fraction[1],e=d(c,this.processor,b),b.checkForPosition(g,f),b.checkForPosition(e,c),this.fraction_builder.build_fraction({numerator:g,denominator:e})},a}(),c(j),i=function(){function a(){}return a.prototype.initialize=function(a,b){this.converter=a,this.fn_builder=b},a.prototype.isType=function(a){return a.fn instanceof Array},a.prototype.convert=function(a,b){var c,e;return e=a.fn[0],c=d(a.fn[1],this.converter,b),this.fn_builder.build_fn({name:e,argument:c})},a}(),c(i),m=function(){function a(){}return a.prototype.initialize=function(a,b){return this.converter=a,this.literal_mappings=b,this.keys=_.keys(this.literal_mappings)},a.prototype.isType=function(a){return-1!==this.keys.indexOf(a)},a.prototype.convert=function(a){return this.converter[this.literal_mappings[a]]()},a}(),c(m),d=function(a,b,c){var d,e;return d="number"==typeof a?[a]:a?a:[],e=b.convert(d,c)},f.lib.math.BuildExpressionFromJavascriptObject=a}).call(this)},{}],7:[function(){(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=function(a,b){return function(){return a.apply(b,arguments)}},L={}.hasOwnProperty,M=function(a,b){function c(){this.constructor=a}for(var d in b)L.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};v=thinkthroughmath,g=function(){function a(){this.cloneData=K(this.cloneData,this)}return a.prototype.initialize=function(a){return null==a&&(a={}),this.component_source=a.component_source,this.id_value=a.id,this.parent_value=a.parent},a.prototype.isNumber=function(){return!1},a.prototype.isExpression=function(){return!1},a.prototype.isMultiplication=function(){return!1},a.prototype.isFraction=function(){return!1},a.prototype.isVariable=function(){return!1},a.prototype.isExponentiation=function(){return!1},a.prototype.isRoot=function(){return!1},a.prototype.preceedingSubexpression=function(){return!1},a.prototype.cloneData=function(a){return v.defaults(a,{id:this.id_value,parent:this.parent_value})},a.prototype.clone=function(a){return null==a&&(a={}),this.klass.build(this.cloneData(a))},a.prototype.id=function(){return this.id_value},a.prototype.subExpressions=function(){return[]},a.prototype.parent=function(){return this.parent_value},a.prototype.withParent=function(a){var b;return b=this.clone({parent:a})},a.prototype.replaceImmediateSubComponentD=function(a,b,c){var d,e,f,g,h;for(h=this[a],e=f=0,g=h.length;g>f;e=++f)d=h[e],d.id()===b.id()&&(c=c.withParent(this),this[a][e]=c);return null},a}(),d=function(a){function b(){return w=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.toString=function(){return"="},b}(g),v.class_mixer(d),f=function(a){function b(){return x=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.buildWithContent=function(a){return this.build({expression:a})},b.buildError=function(){return this.build({is_error:!0})},b.buildUnlessExpression=function(a){return a instanceof this.comps.classes.expression?a:this.buildWithContent([a])},b.prototype.initialize=function(a){var c,d,e,f,g;for(null==a&&(a={}),b.__super__.initialize.apply(this,arguments),c={expression:[],is_error:!1},a=_.extend({},c,a),this.expression=[],g=a.expression,e=0,f=g.length;f>e;e++)d=g[e],this.expression.push(d.withParent(this));return this.is_error=a.is_error},b.prototype.cloneData=function(a){return null==a&&(a={}),v.defaults(b.__super__.cloneData.apply(this,arguments),{expression:_.map(this.expression,function(a){return a.clone()}),is_error:this.is_error,id:this.id_value})},b.prototype.last=function(a){return null==a&&(a=0),this.expression[this.expression.length-1-a]},b.prototype.first=function(){return _.first(this.expression)},b.prototype.nth=function(a){return this.expression[a]},b.prototype.reset=function(){return this.expression=[]},b.prototype.size=function(){return _(this.expression).size()},b.prototype.isBlank=function(){return 0===this.size()},b.prototype.isEmpty=function(){return this.isBlank()},b.prototype.set=function(a){return this.expression=a},b.prototype.append=function(a){var b;return b=_.clone(this.expression),b.push(a.withParent(this)),this.clone({expression:b})},b.prototype.appendD=function(a){return this.expression.push(a.withParent(this))},b.prototype.replaceD=function(a,b){return this.replaceImmediateSubComponentD("expression",a,b)},b.prototype.replaceLast=function(a){return this.withoutLast().append(a.withParent(this))},b.prototype.replaceLastD=function(a){return this.expression[this.expression.length-1]=a.withParent(this)},b.prototype.withoutLast=function(){var a;return a=_.clone(this.expression),a=a.slice(0,a.length-1),this.clone({expression:a})},b.prototype.withoutLastD=function(){return this.expression.splice(this.expression.length-1,1)},b.prototype.isError=function(){return this.is_error},b.prototype.isExpression=function(){return!0},b.prototype.toString=function(){var a,b;return b=function(a){return null!=a?a:{t:"f"}},a=_(this.expression).chain().map(function(a){return a.toString()}).join(", ").value(),"Expression(e: "+b(this.is_error)+", exp: ["+a+"])"},b.prototype.subExpressions=function(){return this.expression},b}(g),v.class_mixer(f),m=function(a){function b(){return C=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return b.__super__.initialize.apply(this,arguments),this.precise=a.precise_lib,this.val=this.normalizeValue(a.value),this.future_as_decimal=a.future_as_decimal},b.prototype.toString=function(){return"#"+this.val},b.prototype.isNumber=function(){return!0},b.prototype.negated=function(){var a;return a=-1*this.val,b.build({value:a})},b.prototype.negatedD=function(){return this.val*=-1},b.prototype.toCalculable=function(){return parseFloat(this.val)},b.prototype.cloneData=function(a){return null==a&&(a={}),v.defaults(b.__super__.cloneData.apply(this,arguments),{value:this.val,future_as_decimal:this.future_as_decimal})},b.prototype.toDisplay=function(){return this.hasDecimal()?this.valueAtPrecision():this.future_as_decimal?""+this.val+".":""+this.val},b.prototype.valueAtPrecision=function(){var a,b;return a=4,b=(""+this.val).split("."),b[1].length>a?""+1*(1*this.val).toFixed(a):""+this.val},b.prototype.value=function(){return this.val},b.prototype.concatenate=function(a){var c;return c=this.future_as_decimal?""+this.val+"."+a:""+this.val+a,b.build({value:c})},b.prototype.concatenateD=function(a){return this.val=this.future_as_decimal?""+this.val+"."+a:""+this.val+a,this.future_as_decimal=!1},b.prototype.futureAsDecimal=function(){var a;return a=!this.hasDecimal(),this.clone({future_as_decimal:a})},b.prototype.futureAsDecimalD=function(a){return this.future_as_decimal=a},b.prototype.hasDecimal=function(){return/\./.test(this.val)},b.prototype.normalizeValue=function(a){var b,c,d;return a=""+a,-1!==a.search(/\//)&&(d=a.split("/"),c=d[0],b=d[1],a=this.precise.div(c,b)),a},b}(g),v.class_mixer(m),e=function(a){function b(){return D=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.baseval=a.base.clone({parent:this}),this.powerval=a.power.clone({parent:this})},b.prototype.base=function(){return this.baseval},b.prototype.power=function(){return this.powerval},b.prototype.preceedingSubexpression=function(){return this.base()},b.prototype.isExponentiation=function(){return!0},b.prototype.updatePower=function(a){return this.klass.build({base:this.base(),power:a})},b.prototype.toString=function(){return"^(b: "+this.base().toString()+", p: "+this.power().toString()+")"},b.prototype.subExpressions=function(){return[this.base(),this.power()]},b.prototype.clone=function(a){var b,c,d;return null==a&&(a={}),c={base:this.base().clone(),power:this.power().clone(),id:this.id_value},b=this.cloneData(),d=this.klass.build(_.extend({},b,c,a))},b.prototype.replaceD=function(a,b){return this.baseval.replaceD(a,b),this.powerval.replaceD(a,b)},b}(g),v.class_mixer(e),n=function(a){function b(){return E=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.pi_value=a.value},b.prototype.toString=function(){return"PI"},b.prototype.cloneData=function(a){var c;return null==a&&(a={}),c={value:this.pi_value},v.defaults(b.__super__.cloneData.apply(this,arguments),c)},b.prototype.isVariable=function(){return!0},b.prototype.value=function(){return this.pi_value||Math.PI},b}(g),v.class_mixer(n),a=function(a){function b(){return F=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.toString=function(){return"Add"},b}(g),v.class_mixer(a),p=function(a){function b(){return G=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.toString=function(){return"Sub"},b}(g),v.class_mixer(p),l=function(a){function b(){return H=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.toString=function(){return"Mult"},b.prototype.isMultiplication=function(){return!0},b}(g),v.class_mixer(l),c=function(a){function b(){return I=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.toString=function(){return"Div"},b}(g),v.class_mixer(c),k=function(a){function b(){return J=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.numerator_value=a.numerator?a.numerator.withParent(this):this.component_source.build_expression({parent:this}),this.denominator_value=a.denominator?a.denominator.withParent(this):this.component_source.build_expression({parent:this})},b.prototype.toString=function(){return"Frac(num: "+this.numerator().toString()+", den: "+this.denominator().toString()+")"},b.prototype.numerator=function(){return this.numerator_value},b.prototype.denominator=function(){return this.denominator_value},b.prototype.subExpressions=function(){return[this.numerator(),this.denominator()]},b.prototype.isFraction=function(){return!0},b.prototype.clone=function(a){var b,c,d;return null==a&&(a={}),c={numerator:this.numerator().clone(),denominator:this.denominator().clone()},b=this.cloneData(),d=this.klass.build(_.extend({},b,c,a))},b}(g),v.class_mixer(k),b=function(a){function b(){return y=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.toString=function(){return"Blnk"},b}(g),v.class_mixer(b),o=function(a){function b(){return z=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.degree_value=a.degree,this.radicand_value=a.radicand},b.prototype.toString=function(){return"Root(deg: "+this.degree().toString()+", rad: "+this.radicand().toString()+")"},b.prototype.degree=function(){return this.degree_value},b.prototype.radicand=function(){return this.radicand_value},b.prototype.updateRadicand=function(a){return this.clone({radicand:a})},b.prototype.isRoot=function(){return!0},b.prototype.cloneData=function(a){var c;return null==a&&(a={}),c={degree:this.degree_value&&this.degree_value.clone(),radicand:this.radicand_value&&this.radicand_value.clone()},v.defaults(b.__super__.cloneData.apply(this,arguments),c)},b.prototype.subExpressions=function(){return[this.degree(),this.radicand()]},b.prototype.replaceD=function(a,b){return this.degree_value.replaceD(a,b),this.radicand_value.replaceD(a,b)},b}(g),v.class_mixer(o),q=function(a){function b(){return A=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.name_value=a.name},b.prototype.name=function(){return this.name_value},b.prototype.clone=function(a){var b,c;return null==a&&(a={}),c={name:this.name_value},b=this.cloneData(),this.klass.build(_.extend({},b,c,a))},b.prototype.toString=function(){return"Var("+this.name()+")"},b.prototype.isVariable=function(){return!0},b}(g),v.class_mixer(q),j=function(a){function b(){return B=b.__super__.constructor.apply(this,arguments)}return M(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.name_value=a.name,this.argument_value=a.argument},b.prototype.cloneData=function(a){return null==a&&(a={}),v.defaults(b.__super__.cloneData.apply(this,arguments),{name:this.name_value,argument:this.argument()&&this.argument().clone()})},b.prototype.subExpressions=function(){return[this.argument()]},b.prototype.toString=function(){return"Fn(name: "+this.name()+", argument: "+this.argument().toString()+")"},b.prototype.argument=function(){return this.argument_value},b.prototype.name=function(){return this.name_value},b}(g),v.class_mixer(j),i=function(){function a(){}return a.prototype.initialize=function(){return this.id=0},a.prototype.next=function(){var a;return a=++this.id},a.prototype.current=function(){return this.id},a}(),v.class_mixer(i),s={expression:f,addition:a,number:m,multiplication:l,division:c,subtraction:p,exponentiation:e,pi:n,equals:d,blank:b,root:o,variable:q,fraction:k,fn:j},h=function(){function a(){}return a.prototype.initialize=function(a){return this.id_source=i.build(),this.precise_lib=a},a.prototype.classes=s,a}();for(u in s)t=s[u],"number"!==u&&(r=function(a,b){return function(a){return null==a&&(a={}),a.id||(a.id=this.id_source.next()),a.component_source=this,b.build(a)}}(u,t),h.prototype["build_"+u]=r);h.prototype.build_number=function(a){return null==a&&(a={}),a.id||(a.id=this.id_source.next()),a.precise_lib||(a.precise_lib=this.precise_lib),m.build(a)},v.lib.math.ExpressionComponentSource=v.class_mixer(h)}).call(this)},{}],8:[function(){(function(){var a,b,c,d,e,f,g;g=thinkthroughmath,c=g.class_mixer,e=g.lib.object_refinement,f=e.build(),d=g.lib.math.ExpressionComponentSource.build(),b=function(a,b){var c;return null==b&&(b=!1),c=function(c,d){var e;return e=c instanceof a,d.saveFalseForReport(e,this.unrefined(),c,"different types "+a.name),e?b?this[b](c,d):!0:!1},g.logger.instrument({name:"buildIsEqual function",fn:c})},f.forType(d.classes.addition,{isEqual:b(d.classes.addition)}),f.forType(d.classes.blank,{isEqual:b(d.classes.blank)}),f.forType(d.classes.division,{isEqual:b(d.classes.division)}),f.forType(d.classes.exponentiation,{isEqual:b(d.classes.exponentiation,"checkBaseAndPowerEquality"),checkBaseAndPowerEquality:function(a,b){var c,d;return c=f.refine(this.base()).isEqual(a.base(),b),d=f.refine(this.power()).isEqual(a.power(),b),c&&d}}),f.forType(d.classes.expression,{isExpressionEqual:function(a,b){var c,d,e,h;return g.logger.info("isExpressionEqual",this.unrefined(),a),d=this.is_error===a.is_error,b.saveFalseForReport(d,this.unrefined(),a,"error values not equal"),e=this.is_open===a.is_open,b.saveFalseForReport(e,this.unrefined(),a,"open values not equal"),d&&e?(c=_.chain(this.expression).map(function(c,d){var e;return e=f.refine(c).isEqual(a.nth(d),b)}).contains(!1).value(),c?!1:(h=_(this.expression).size()===_(a.expression).size(),b.saveFalseForReport(h,this.unrefined(),a,"size values not equal"))):!1},isEqual:function(a,b){var c;return c=b.saveFalseForReport(a instanceof d.classes.expression,this.unrefined(),a,"Wrong types"),c?this.isExpressionEqual(a,b):!1}}),f.forType(d.classes.equals,{isEqual:b(d.classes.equals)}),f.forType(d.classes.fn,{isEqual:b(d.classes.fn,"checkNameAndArgumentEquality"),checkNameAndArgumentEquality:function(a,b){var c,d;return d=this.name()===a.name(),c=f.refine(this.argument()).isEqual(a.argument(),b),d&&c}}),f.forType(d.classes.fraction,{isEqual:b(d.classes.fraction,"checkNumeratorAndDenominatorEquality"),checkNumeratorAndDenominatorEquality:function(a,b){var c,d;return d=f.refine(this.numerator()).isEqual(a.numerator(),b),c=f.refine(this.denominator()).isEqual(a.denominator(),b),d&&c}}),f.forType(d.classes.multiplication,{isEqual:b(d.classes.multiplication)}),f.forType(d.classes.number,{isEqual:b(d.classes.number,"checkNumberValues"),checkNumberValues:function(a,b){var c;return c=parseFloat(""+this.value()).toFixed(2)===parseFloat(""+a.value()).toFixed(2),b.saveFalseForReport(c,this.unrefined(),a,"Numeric values not equal")}}),f.forDefault({isEqual:function(){throw console.log(this),"NOT IMPLEMENTED"}}),f.forType(d.classes.pi,{isEqual:b(d.classes.pi)}),f.forType(d.classes.subtraction,{isEqual:b(d.classes.subtraction)}),f.forType(d.classes.root,{isEqual:b(d.classes.root,"checkDegreeAndRadicand"),checkDegreeAndRadicand:function(a,b){var c,d;return c=f.refine(this.degree()).isEqual(a.degree(),b),d=f.refine(this.radicand()).isEqual(a.radicand(),b),c&&d}}),f.forType(d.classes.variable,{isEqual:b(d.classes.variable,"checkNames"),checkNames:function(a,b){var c;return c=""+this.name()==""+a.name(),b.saveFalseForReport(c,this.unrefined(),a,"Variable names not equal")}}),f.forDefault({isEqual:function(){throw["Unimplemented equality refinement for ",this.unrefined()]}}),a=function(){function a(){}return a.prototype.initialize=function(){return this.report_saved=!1},a.prototype.calculate=function(a,b){var c;return this.first=a,this.second=b,c=f.refine(this.first),this._equality_results=c.isEqual(this.second,this),this},a.prototype.isEqual=function(){return this._equality_results},a.prototype.notEqualReport=function(a,b,c){return this.a=a,this.b=b,this.not_eql_msg=c,this.report_saved=!0},a.prototype.saveFalseForReport=function(a,b,c,d){return a?!0:(this.report_saved||this.notEqualReport(b,c,d),!1)},a}(),c(a),a.isEqual=function(b,c){return a.build().calculate(b,c).isEqual()},a.equalityCalculation=function(b,c){var d;
return d=a.build(),d.calculate(b,c),d},g.lib.math.ExpressionEquality=a}).call(this)},{}],9:[function(){(function(){var a,b,c,d,e,f,g,h;h=thinkthroughmath,f=h.logger,d=h.class_mixer,g=h.lib.object_refinement,a=function(){function a(){}return a.prototype.initialize=function(a,b,c,d,e){var g,i;return a=a,i=c.build(),i.forType(a.classes.number,{eval:function(){return this}}),i.forType(a.classes.exponentiation,{eval:function(b,c){var e,f;if("exponentiation"===c){if(this.base().isEmpty()||this.power().isEmpty())throw new d("Invalid Expression");return e=i.refine(this.base()).eval().toCalculable(),f=i.refine(this.power()).eval().toCalculable(),h.logger.info("exponentiation",e,f),a.classes.number.build({value:Math.pow(e,f)})}}}),i.forType(a.classes.pi,{eval:function(){return a.classes.number.build({value:this.value()})}}),i.forType(a.classes.addition,{eval:function(b,c){var f,g;if("addition"===c){if(g=b.previousValue(),f=b.nextValue(),g&&f)return b.handledSurrounding(),a.classes.number.build({value:e.add(g,f)});throw new d("Invalid Expression")}}}),i.forType(a.classes.subtraction,{eval:function(b,c){var f,g;if("addition"===c){if(g=b.previousValue(),f=b.nextValue(),g&&f)return b.handledSurrounding(),a.classes.number.build({value:e.sub(g,f)});throw new d("Invalid Expression")}}}),i.forType(a.classes.multiplication,{eval:function(b,c){var f,g;if("multiplication"===c){if(g=b.previousValue(),f=b.nextValue(),g&&f)return b.handledSurrounding(),a.classes.number.build({value:e.mul(g,f)});throw new d("Invalid Expression")}}}),i.forType(a.classes.division,{eval:function(b,c){var f,g;if("multiplication"===c){if(g=b.previousValue(),f=b.nextValue(),g&&f)return b.handledSurrounding(),a.classes.number.build({value:e.div(g,f)});throw new d("Invalid Expression")}}}),i.forType(a.classes.fraction,{eval:function(b,c){var f,g;if("multiplication"===c){if(g=i.refine(this.numerator()).eval().toCalculable(),f=i.refine(this.denominator()).eval().toCalculable(),g&&f)return a.build_number({value:e.div(g,f)});throw new d("Invalid Expression")}}}),this.refinement_val=i,g=function(){function a(){}return a.prototype.initialize=function(a){return this.expression=a,this.expression_index=-1},a.prototype.perform=function(a){var b,c,d;for(d=[],this.expression_index=0;this.expression.length>this.expression_index;)c=i.refine(this.expression[this.expression_index]),b=c.eval(this,a),b&&(this.expression[this.expression_index]=b),this.expression_index+=1;return this.expression},a.prototype.previousValue=function(){var a;return a=this.expression[this.expression_index-1],a?a.value():void 0},a.prototype.nextValue=function(){var a;return a=this.expression[this.expression_index+1],a?a.value():void 0},a.prototype.handledPrevious=function(){return this.expression.splice(this.expression_index-1,1),this.expression_index-=1},a.prototype.handledSurrounding=function(){return this.handledPrevious(),this.expression.splice(this.expression_index+1,1)},a}(),b(g),i.forType(a.classes.expression,{eval:function(){var a;return a=this.expression,f.info("before parenthetical",a),a=g.build(a).perform("parenthetical"),f.info("before exponentiation",a),a=g.build(a).perform("exponentiation"),f.info("before multiplication",a),a=g.build(a).perform("multiplication"),f.info("before addition",a),a=g.build(a).perform("addition"),f.info("before returning",a),_(a).first()}})},a.prototype.refinement=function(){return this.refinement_val},a}(),h.class_mixer(a),c=function(a){return this.name="MalformedExpressionError",this.message=a,this.stack=(new Error).stack},c.prototype=new Error,e=h.lib.math.ExpressionComponentSource.build(),b=function(){function b(){}return b.prototype.initialize=function(b,f){return this.expression=b,this.opts=null!=f?f:{},this.comps=this.opts.comps||e,this.precise=h.lib.math.Precise.build(),this.refinement=a.build(this.comps,d,g,c,this.precise).refinement()},b.prototype.resultingExpression=function(){var a,b;b=!1;try{b=this.evaluate()}catch(d){if(a=d,!(a instanceof c))throw a}return b?this.comps.build_expression({expression:[b]}):this.expression.clone({is_error:!0})},b.prototype.evaluate=function(){var a,b;return a=this.refinement.refine(this.expression),b=a.eval()},b}(),d(b),h.lib.math.ExpressionEvaluation=b}).call(this)},{}],10:[function(){(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb={}.hasOwnProperty,ob=function(a,b){function c(){this.constructor=a}for(var d in b)nb.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};K=thinkthroughmath,E=K.class_mixer,G=K.lib.math.ExpressionEvaluation,J=K.lib.object_refinement,M=function(){function a(){}return a.prototype.initialize=function(a){return null==a&&(a={}),this.comps=a.comps,this.expr=a.expr,this.found=!1},a.prototype.findAndPerformAction=function(a){var b;return b=this.nextSubExpression(a),b&&(b=this.findAndPerformAction(b)),this.found?this.updateWithNewSubexp(a,b):a instanceof this.comps.classes.expression&&a.isOpen()?(this.found=!0,this.action(a)):a},a.prototype.perform=function(a){return this.action=a,this.findAndPerformAction(this.expr)},a.prototype.wasFound=function(){return this.found},a.prototype.updateWithNewSubexp=function(a,b){return a instanceof this.comps.classes.expression?a.replaceLast(b):a instanceof this.comps.classes.exponentiation?a.updatePower(b):a instanceof this.comps.classes.root?a.updateRadicand(b):void 0},a.prototype.nextSubExpression=function(a){return a instanceof this.comps.classes.expression?a.last():a instanceof this.comps.classes.exponentiation?a.power():a instanceof this.comps.classes.root?a.radicand():!1},a.prototype.performOrDefault=function(a){var b;return this.action=a,b=this.findAndPerformAction(this.expr),this.wasFound()?b:this.action(this.expr)},a}(),E(M),N=function(){function a(){}return a.prototype.initialize=function(a){this.comps=a},a.prototype.invokeD=function(a){var b;return b=a.last(),b&&(b.isNumber()||b.isExpression()||b.isVariable()||b.isFraction()||b.isExponentiation()||b.isRoot())?(a.appendD(this.comps.build_multiplication()),a):a},a}(),E(N),L=function(){function a(){}return a.prototype.initialize=function(a,b){this.expr=a,this.traversal=b},a.prototype.clone=function(){return this.expr=this.expr.clone(),this},a.prototype.withComponent=function(a,b){var c;return c=this.traversal.build(this.expr).findForID(a.position()),b(c),this},a.prototype.value=function(){return this.expr},a}(),E(L),r=function(){function a(){}return a.prototype.initialize=function(a){return null==a&&(a={}),this.comps=a.comps,this.pos=a.pos,this.traversal=a.traversal},a.prototype.evaluate=function(a){var b;return b=G.build(a).resultingExpression()},a.prototype.value=function(a){var b;return b=G.build(a).evaluate(),b?b.value():0},a.prototype.M=function(a){return this.expr=a,L.build(this.expr,this.traversal)},a.prototype.isOperator=function(a){var b;switch(b=this.comps.classes,a.klass){case b.equals:case b.addition:case b.subtraction:case b.multiplication:case b.division:return!0;default:return!1}},a.prototype.withoutTrailingOperatorD=function(a){return this.isOperator(a.last())&&a.withoutLastD(),a},a}(),t=function(){function a(){}return a.prototype.initialize=function(a){this.traversal=a},a.prototype.updatePositionTo=function(a,b){var c,d;return a=a.clone(),c=!1,d=!1,this.traversal.build(a).each(function(a){var e;return!c&&(e=b(a))?(d=a.id(),c=!0):void 0}),a.clone({position:d})},a}(),E(t),o=function(a){function b(){return O=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b;return b=this.evaluate(a.expression()),a.clone({expression:b,position:b.id()})},b}(r),E(o),z=function(a){function b(){return P=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c;return c=this.value(a.expression()),b=this.comps.build_expression({expression:[this.comps.build_number({value:c*c})]}),this.pos.build({expression:b,position:b.id()})},b}(r),E(z),b=function(a){function b(){return $=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.doAppendD=function(a){var b,c;return b=a.last(),b?b.isNumber()?b.futureAsDecimalD(!0):(N.build(this.comps).invokeD(a),c=this.comps.build_number({value:0}),c.futureAsDecimalD(!0),a.appendD(c)):(c=this.comps.build_number({value:0}),c.futureAsDecimalD(!0),a.appendD(c))},b.prototype.perform=function(a){var b,c=this;return b=this.M(a).clone().withComponent(a,function(b){return c.doAppendD(b,a)}).value()},b}(r),E(b),i=function(a){function b(){return gb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.val=a.value},b.prototype.doAppendD=function(a){var b,c;return c=this.comps.build_number({value:this.val}),b=a.last(),b?b instanceof this.comps.classes.number?a.last().concatenateD(this.val):b instanceof this.comps.classes.exponentiation||!this.isOperator(b)?(a.appendD(this.comps.build_multiplication()),a.appendD(c)):a.appendD(c):a.appendD(c)},b.prototype.perform=function(a){var b,c=this;return b=this.M(a).clone().withComponent(a,function(b){return c.doAppendD(b,a)}).value()},b}(r),E(i),q=function(a){function b(){return hb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.power=a.power},b.prototype.baseExpression=function(a){return a instanceof this.comps.classes.expression?a:this.comps.build_expression({expression:[a]})},b.prototype.powerExpression=function(){var a;return a=this.power?this.comps.build_expression({expression:[this.comps.build_number({value:this.power})]}):this.comps.build_expression({expression:[]})},b.prototype.exponentiateLastOfComponent=function(a){var b,c,d,e;if(!a.isEmpty())return d=a.last(),(c=d.preceedingSubexpression())?b=this.baseExpression(c):this.isOperator(d)?(a.withoutLastD(),b=this.baseExpression(a.last())):b=this.baseExpression(a.last()),e=this.powerExpression(),this.pos_id=this.posID(e,a),a.replaceLastD(this.comps.build_exponentiation({base:b,power:e}))},b.prototype.posID=function(a){return a.id()},b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),b.isEmpty()?a:(c=this.M(a).clone().withComponent(a,function(a){return d.exponentiateLastOfComponent(a)}).value(),c.clone({position:this.pos_id}))},b}(r),E(q),e=function(a){function b(){return ib=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.exponent_content=a.power},b.prototype.perform=function(a){var b,c,d,e,f,g=this;return c=this.exponent_content?[this.comps.build_number({value:this.exponent_content})]:[],b=this.comps.build_expression(),e=this.comps.build_expression({expression:c}),d=this.comps.build_exponentiation({base:b,power:e}),f=this.M(a).clone().withComponent(a,function(a){return N.build(g.comps).invokeD(a),a.appendD(d)}).value(),f.clone({position:b.id()})},b}(r),E(e),h=function(a){function b(){return jb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),b.isEmpty()?a:c=this.M(a).clone().withComponent(a,function(a){return d.withoutTrailingOperatorD(a).appendD(d.comps.build_multiplication())}).value()},b}(r),E(h),d=function(a){function b(){return kb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return a=a.clone({position:a.expression().id()}),b=this.comps.build_equals(),c=this.M(a).clone().withComponent(a,function(a){return d.withoutTrailingOperatorD(a).appendD(b)}).value()},b}(r),E(d),c=function(a){function b(){return lb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),b.isEmpty()?a:c=this.M(a).clone().withComponent(a,function(a){return d.withoutTrailingOperatorD(a).appendD(d.comps.build_division())}).value()},b}(r),E(c),a=function(a){function b(){return mb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),b.isEmpty()?a:c=this.M(a).clone().withComponent(a,function(a){return d.withoutTrailingOperatorD(a).appendD(d.comps.build_addition())}).value()},b}(r),E(a),m=function(a){function b(){return Q=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),c=this.M(a).clone().withComponent(a,function(a){return d.withoutTrailingOperatorD(a).appendD(d.comps.build_subtraction())}).value()},b}(r),E(m),c=function(a){function b(){return R=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),b.isEmpty()?a:c=this.M(a).clone().withComponent(a,function(a){return d.withoutTrailingOperatorD(a).appendD(d.comps.build_division())}).value()},b}(r),E(c),w=function(a){function b(){return S=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.negateComp=function(a){var b;return b=a.last(),b instanceof this.comps.classes.number?b.negatedD():void 0},b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),c=this.M(a).clone().withComponent(a,function(a){return d.negateComp(a)}).value()},b}(r),E(w),l=function(a){function b(){return T=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d,e=this;return b=a.expression(),c=this.comps.build_expression(),d=this.M(a).clone().withComponent(a,function(a){return N.build(e.comps).invokeD(a),a.appendD(c)}).value(),d.clone({position:c.id()})},b}(r),E(l),p=function(a){function b(){return U=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),c=this.M(a).clone().withComponent(a,function(a){var b;return b=a.parent(),d.position_id=b?b.isExpression()?b.id():b.parent().id():a.id()}).value(),c.clone({position:this.position_id})},b}(r),E(p),j=function(a){function b(){return V=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.pi_value=a.value},b.prototype.perform=function(a){var b,c,d=this;return b=a.expression(),c=this.M(a).clone().withComponent(a,function(a){return N.build(d.comps).invokeD(a),a.appendD(d.comps.build_pi({value:d.pi_value}))}).value()},b}(r),E(j),k=function(a){function b(){return W=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.degree=a.degree},b.prototype.perform=function(a){var b,c,d,e,f=this;return b=this.degree?this.comps.build_expression({expression:[this.comps.build_number({value:this.degree})]}):this.comps.build_expression(),c=this.comps.build_expression({expression:[]}),e=this.comps.build_root({degree:b,radicand:c}),d=this.M(a).clone().withComponent(a,function(a){return N.build(f.comps).invokeD(a),a.appendD(e)}).value(),d.clone({position:c.id()})},b}(r),E(k),n=function(a){function b(){return X=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.variable_name=a.variable},b.prototype.perform=function(a){var b,c,d,e=this;return b=a.expression(),d=this.comps.build_variable({name:this.variable_name}),c=this.M(a).clone().withComponent(a,function(a){return N.build(e.comps).invokeD(a),a.appendD(d)}).value()},b}(r),E(n),g=function(a){function b(){return Y=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d,e,f,g=this;return c=a.expression(),e=this.comps.build_expression(),b=this.comps.build_expression(),d=this.comps.build_fraction({numerator:e,denominator:b}),f=this.M(a).clone().withComponent(a,function(a){return N.build(g.comps).invokeD(a),a.appendD(d)}).value(),f.clone({position:e.id()})},b}(r),E(g),f=function(a){function b(){return Z=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.name=a.name},b.prototype.perform=function(a){var b,c,d,e,f=this;return c=a.expression(),b=this.comps.build_expression(),d=this.comps.build_fn({name:this.name,argument:b}),e=this.M(a).clone().withComponent(a,function(a){return N.build(f.comps).invokeD(a),a.appendD(d)}).value()},b}(r),E(f),A=function(a){function b(){return _=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b,c,d;return b=a.expression(),d=this.value(b),c=Math.sqrt(parseFloat(d)),isNaN(c)?(b=b.clone({is_error:!0}),this.pos.build({expression:b,position:b.id()})):(b=this.comps.build_expression({expression:[this.comps.build_number({value:""+c})]}),this.pos.build({expression:b,position:b.id()}))},b}(r),E(A),y=function(a){function b(){return ab=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(){var a;return a=this.comps.build_expression({expression:[]}),this.pos.build({expression:a,position:a.id()})},b}(r),E(y),C=function(a){function b(){return bb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.new_position_element_id=a.element_id,this.new_position_element_type=a.type},b.prototype.perform=function(a){return a.clone({position:this.new_position_element_id,type:this.new_position_element_type})},b}(r),E(C),B=function(a){function b(){return cb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.initialize=function(a){return null==a&&(a={}),b.__super__.initialize.apply(this,arguments),this.variables=a.variables},b.prototype.perform=function(a){var b,c=this;return b=a.clone(),this.traversal.build(b).each(function(a){var b;return a instanceof c.comps.classes.variable&&c.isThisVariable(a.name())?(b=c.comps.build_number({value:c.variableValue(a.name())}),a.parent().replaceD(a,b)):void 0}),b},b.prototype.isThisVariable=function(a){var b,c,d,e;for(e=this.variables,c=0,d=e.length;d>c;c++)if(b=e[c],b.name===a)return!0},b.prototype.variableValue=function(a){var b,c,d,e;for(e=this.variables,c=0,d=e.length;d>c;c++)if(b=e[c],b.name===a)return b.value},b}(r),E(B),u=function(a){function b(){return db=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b;return b=a.expression().clone(),b.expression.splice(this.indexOfEquals(b.expression),b.expression.length),a.clone({expression:b})},b.prototype.indexOfEquals=function(a){var b,c;for(c in a)if(b=a[c],b instanceof this.comps.classes.equals)return 1*c},b}(r),E(u),v=function(a){function b(){return eb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b;return b=a.expression().clone(),b.expression.splice(0,this.indexOfEquals(b.expression)+1),a.clone({expression:b})},b.prototype.indexOfEquals=function(a){var b,c;for(c in a)if(b=a[c],b instanceof this.comps.classes.equals)return 1*c},b}(r),E(v),x=function(a){function b(){return fb=b.__super__.constructor.apply(this,arguments)}return ob(b,a),b.prototype.perform=function(a){var b;return b=this.M(a).clone().withComponent(a,function(a){return a.withoutLastD()}).value()},b}(r),E(x),F={calculate:o,square:z,append_decimal:b,append_number:i,exponentiate_last:q,append_exponentiation:e,append_multiplication:h,append_addition:a,append_equals:d,append_subtraction:m,negate_last:w,append_sub_expression:l,exit_sub_expression:p,append_division:c,append_pi:j,update_position:C,square_root:A,append_root:k,append_variable:n,reset:y,substitute_variables:B,get_left_side:u,get_right_side:v,append_fraction:g,append_fn:f,remove_pointed_at:x},s=function(){function a(){}return a.prototype.initialize=function(a,b,c){var d=this;return this.comps=a,this.pos=b,this.traversal=c,this.utils={},this.utils.build_expression_position_manipulator=function(){return t.build(d.traversal)}},a.prototype.classes=F,a}(),K.class_mixer(s);for(I in F)H=F[I],D=function(a,b){return function(a){return null==a&&(a={}),a.comps=this.comps,a.pos=this.pos,a.traversal=this.traversal,b.build(a)}}(I,H),s.prototype["build_"+I]=D;K.lib.math.ExpressionManipulationSource=s}).call(this)},{}],11:[function(){(function(){var a,b;b=thinkthroughmath,a=function(){function a(){}return a.prototype.initialize=function(a){return null==a&&(a={}),this.expr=a.expression,this.pos=a.position,this.type_val=a.type},a.prototype.expression=function(){return this.expr},a.prototype.position=function(){return this.pos},a.prototype.type=function(){return this.type_val},a.prototype.isPointedAt=function(a){return""+a.id()==""+this.position()},a.prototype.clone=function(a){var b,c;return null==a&&(a={}),b={expression:this.expr.clone(),position:this.pos,type:this.type_val},c=this.klass.build(_.extend({},b,a))},a.buildExpressionPositionAsLast=function(a){return this.build({expression:a,position:a.id()})},a}(),b.lib.math.ExpressionPosition=b.class_mixer(a)}).call(this)},{}],12:[function(){(function(){var a,b,c,d;d=thinkthroughmath,b=d.class_mixer,c=d.lib.object_refinement,a=function(){function a(){}return a.prototype.initialize=function(a,b){var e,f;return this.expression_position=a,this.expression=this.expression_position.expression(),this.position=this.expression_position.position(),this.comps=d.lib.math.ExpressionComponentSource.build(),e=this.comps,this.ref=f=c.build(),f.forDefault({toString:function(){return"?"},toHTMLString:function(){return"?"}}),f.forType(e.classes.addition,{toString:function(){return"+"},toHTMLString:function(){return this.toString()}}),f.forType(e.classes.exponentiation,{base:function(a){return null==a&&(a="toString"),f.refine(this.unrefined().base())[a]({include_parentheses_if_single:!1})},power:function(a){return null==a&&(a="toString"),f.refine(this.unrefined().power())[a]({include_parentheses_if_single:!0})},toString:function(){return""+this.base()+" ^ "+this.power()},toHTMLString:function(){return""+this.base("toHTMLString")+" &circ; "+this.power("toHTMLString")}}),f.forType(e.classes.multiplication,{toString:function(){return"*"},toHTMLString:function(){return"&times;"}}),f.forType(e.classes.division,{toString:function(){return"/"},toHTMLString:function(){return"&divide;"}}),f.forType(e.classes.subtraction,{toString:function(){return"-"},toHTMLString:function(){return"-"}}),f.forType(e.classes.expression,{toString:function(a){var b;return null==a&&(a={}),a=this.optsWithDefaults(a),b=this.mapconcatWithMethod("toString",a),this.maybeWrapWithParentheses(b,a)},toHTMLString:function(a){var b;return null==a&&(a={}),a=this.optsWithDefaults(a),b=this.mapconcatWithMethod("toHTMLString",a),this.maybeWrapWithParentheses(b,a)},mapconcatWithMethod:function(a){return _(this.expression).map(function(b){return f.refine(b)[a]()}).join(" ")},maybeWrapWithParentheses:function(a,c){var d,e;return c.skip_parentheses?a:(e=c.skip_parentheses?"":c.include_parentheses_if_single||1!==this.expression.length?"( ":"",d=b.isCursorWithinComponent(this)?"":this.expression.length>1?" )":c.include_parentheses_if_single&&1===this.expression.length?" )":"",""+e+a+d)},decideWrap:function(){},optsWithDefaults:function(a){return null==a&&(a={}),d.defaults(a,{skip_parentheses:!1,include_parentheses_if_single:!0})}}),f.forType(e.classes.blank,{toString:function(){return""},toHTMLString:function(){return""}}),f.forType(e.classes.number,{toString:function(){return this.toDisplay()},toHTMLString:function(){return this.toDisplay()}}),f.forType(e.classes.pi,{toString:function(){return"pi"},toHTMLString:function(){return"<span class='expression-to-string-pi'>&pi;</span>"}})},a.prototype.toString=function(){return this.ref.refine(this.expression).toString({skip_parentheses:!0})},a.prototype.toHTMLString=function(){return this.ref.refine(this.expression).toHTMLString({skip_parentheses:!0})},a}(),b(a),a.toString=function(b,c){return a.build(b,c).toString()},a.toHTMLString=function(b,c){return a.build(b,c).toHTMLString()},d.lib.math.ExpressionToString=a}).call(this)},{}],13:[function(){(function(){var a,b,c,d;d=thinkthroughmath,b=function(){function b(){}return b.prototype.initialize=function(a,b){return this.expr_classes=a,this.expression_position=b,this.expr=this.expression_position.expression()},b.prototype.each=function(a,b){var c,d,e,f,g;for(null==b&&(b=this.expr),a(b),d=b.subExpressions(),g=[],e=0,f=d.length;f>e;e++)c=d[e],g.push(this.each(a,c));return g},b.prototype.findForID=function(a){var b;return b=!1,this.each(function(c){return""+c.id()==""+a?b=c:void 0}),b},b.prototype.hasEquals=function(){var a,b=this;return a=!1,this.each(function(c){return c instanceof b.expr_classes.equals?a=!0:void 0}),a},b.prototype.hasVariableNamed=function(a){var b,c=this;return b=!1,this.each(function(d){return d instanceof c.expr_classes.variable&&d.name()===a?b=!0:void 0}),b},b.prototype.buildExpressionComponentContainsCursor=function(){return a.build(this.expression_position,this)},b}(),d.class_mixer(b),c=function(){function a(){}return a.prototype.initialize=function(a){this.expression_component_classes=a},a.prototype.build=function(a){return this.expression_position=a,b.build(this.expression_component_classes,this.expression_position)},a}(),d.class_mixer(c),a=function(){function a(){}return a.prototype.initialize=function(a,b){this.expression_position=a,this.traversal=b},a.prototype.isCursorWithinComponent=function(a){return-1!==this.componentIDsWithCursor().indexOf(a.id())},a.prototype.cursorComponent=function(){return this.cursorComponent_val||(this.cursorComponent_val=this.traversal.findForID(this.expression_position.position()))},a.prototype.componentIDsWithCursor=function(){var a,b;if(!this.componentIDsWithCursor_val){for(b=[],a=this.cursorComponent();a;)b+=a.id(),a=a.parent();this.componentIDsWithCursor_val=b}return this.componentIDsWithCursor_val},a}(),d.class_mixer(a),d.lib.math.ExpressionTraversal=d.class_mixer(b),d.lib.math.ExpressionTraversalBuilder=d.class_mixer(c)}).call(this)},{}],14:[function(){(function(){var a,b,c;c=thinkthroughmath,b=1e7,a=function(){function a(){}return a.prototype.initialize=function(a){this.adjustment_factor=null!=a?a:b},a.prototype.convertInternal=function(a){return parseInt((parseFloat(a)*this.adjustment_factor).toFixed())},a.prototype.convertExternal=function(a){return""+a/this.adjustment_factor},a.prototype.convertExternal2=function(a){return""+a/(this.adjustment_factor*this.adjustment_factor)},a.prototype.sub=function(a,b){return this.wc(a,b,function(a,b){return a-b})},a.prototype.add=function(a,b){return this.wc(a,b,function(a,b){return a+b})},a.prototype.mul=function(a,b){return this.wc2(a,b,function(a,b){return a*b})},a.prototype.div=function(a,b){return this.wc0(a,b,function(a,b){return a/b})},a.prototype.wc=function(a,b,c){var d,e;return d=this.convertInternal(a),e=this.convertInternal(b),this.convertExternal(c(d,e))},a.prototype.wc2=function(a,b,c){var d,e;return d=this.convertInternal(a),e=this.convertInternal(b),this.convertExternal2(c(d,e))},a.prototype.wc0=function(a,b,c){var d,e;return d=this.convertInternal(a),e=this.convertInternal(b),""+c(d,e)},a}(),c.lib.math.Precise=c.class_mixer(a)}).call(this)},{}],15:[function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1})},{}],16:[function(){(function(){var a,b,c,d,e,f,g,h,i,j,k,l;k=thinkthroughmath,e=k.class_mixer,g=k.lib.math.ExpressionToString,h=k.lib.historic_value,l=k.widgets.UIElements.build(),i=k.widgets.ButtonBuilder,f=k.lib.math.ExpressionComponentSource.build(),d="ttm-calculator",j=function(a){return a.empty()&&b.build_widget(a),a.dialog({dialogClass:"calculator-dialog",title:"Calculator"}),a.dialog("open"),a.dialog({position:{my:"right center",at:"right center",of:window}})},b=function(){function a(){}return a.build_widget=function(b){var c;return c=k.lib.math.math_lib.build(),a.build(b,c,k.logger)},a.prototype.initialize=function(a,b,d){return this.element=a,this.math=b,this.logger=d,this.view=c.build(this,this.element,this.math),this.expression_position=h.build(),this.updateCurrentExpressionWithCommand(this.math.commands.build_reset())},a.prototype.displayValue=function(){var a,b,c,d;return c=this.expression_position.current(),a=c.expression(),b=this.math.traversal.build(c).buildExpressionComponentContainsCursor(),a.isError()?this.errorMsg():(d=g.toHTMLString(c,b),0===d.length?"0":d)},a.prototype.display=function(){var a;return a=this.displayValue(),this.view.display(a)},a.prototype.errorMsg=function(){return"Error"},a.prototype.updateCurrentExpressionWithCommand=function(a){var b;return b=a.perform(this.expression_position.current()),this.reset_on_next_number=!1,this.expression_position.update(b),this.display(),this.expression_position.current()},a.prototype.numberClick=function(a){var b;return this.reset_on_next_number&&(this.reset_on_next_number=!1,this.updateCurrentExpressionWithCommand(this.math.commands.build_reset())),b=this.math.commands.build_append_number({value:a.value}),this.updateCurrentExpressionWithCommand(b)},a.prototype.exponentClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_exponentiate_last())},a.prototype.negativeClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_negate_last())},a.prototype.additionClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_addition())},a.prototype.multiplicationClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_multiplication())},a.prototype.divisionClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_division())},a.prototype.subtractionClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_subtraction())},a.prototype.decimalClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_decimal())},a.prototype.clearClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_reset())},a.prototype.equalsClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_calculate()),this.reset_on_next_number=!0},a.prototype.squareClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_square()),this.reset_on_next_number=!0},a.prototype.squareRootClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_square_root()),this.reset_on_next_number=!0},a.prototype.lparenClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_sub_expression())},a.prototype.rparenClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_exit_sub_expression())},a.prototype.piClick=function(){return this.updateCurrentExpressionWithCommand(this.math.commands.build_append_pi())},a}(),e(b),a=function(){function a(){}return a.prototype.initialize=function(a){this.components=a},a.prototype.render=function(a){return this.element=a,this.render_components(["square","square_root","exponent","clear"]),this.render_components(["pi","lparen","rparen","division"]),this.render_numbers([7,8,9]),this.render_component("multiplication"),this.render_numbers([4,5,6]),this.render_component("subtraction"),this.render_numbers([1,2,3]),this.render_component("addition"),this.render_numbers([0]),this.render_components(["decimal","negative","equals"])},a.prototype.render_numbers=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.components.numbers[b].render({element:this.element}));
return e},a.prototype.render_component=function(a){return this.components[a].render({element:this.element})},a.prototype.render_components=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.render_component(b));return e},a}(),e(a),c=function(){function b(){}return b.prototype.initialize=function(b,c,d){var e,f,g=this;return this.calc=b,this.element=c,this.math=d,f=i.build({element:this.element,ui_elements:l}),e={},e.numbers=f.base10Digits({click:function(a){return g.calc.numberClick(a)}}),e.negative=f.negative({click:function(){return g.calc.negativeClick()}}),e.decimal=f.decimal({click:function(){return g.calc.decimalClick()}}),e.addition=f.addition({click:function(){return g.calc.additionClick()}}),e.multiplication=f.multiplication({click:function(){return g.calc.multiplicationClick()}}),e.division=f.division({click:function(){return g.calc.divisionClick()}}),e.subtraction=f.subtraction({click:function(){return g.calc.subtractionClick()}}),e.equals=f.equals({click:function(){return g.calc.equalsClick()}}),e.clear=f.clear({click:function(){return g.calc.clearClick()}}),e.square=f.square({click:function(){return g.calc.squareClick()}}),e.square_root=f.root({click:function(){return g.calc.squareRootClick()}}),e.exponent=f.caret({click:function(){return g.calc.exponentClick()}}),e.lparen=f.lparen({click:function(){return g.calc.lparenClick()}}),e.rparen=f.rparen({click:function(){return g.calc.rparenClick()}}),e.pi=f.pi({click:function(){return g.calc.piClick()}}),this.layout=a.build(e),this.render()},b.prototype.display=function(a){var b;return b=this.element.find("figure.calculator-display"),b.html(a),b.scrollLeft(9999999)},b.prototype.render=function(){var a;return this.element.append("<div class='"+d+"'></div>"),a=this.element.find("div."+d),a.append("<figure class='calculator-display'>0</figure>"),this.layout.render(a)},b}(),e(c),b.openWidgetDialog=j,k.widgets.Calculator=b}).call(this)},{}],17:[function(){(function(){var a,b,c;c=thinkthroughmath,b=function(a){return"<span class='math-variable'>"+a+"</span>"},a=function(){function a(){}return a.prototype.initialize=function(a){return this.opts=null!=a?a:{},this.ui_elements=this.opts.ui_elements},a.prototype.base10Digits=function(a){var b,c,d,e=this;for(null==a&&(a={}),d=[],b=c=0;9>=c;b=++c)d.push(function(b){return e.button({value:""+b,"class":"math-button number-specifier number"},a)}(b));return d},a.prototype.caret=function(a){return this.button({value:"^",label:"&circ;","class":"math-button other caret"},a)},a.prototype.negative=function(a){return this.button({value:"negative",label:"(&ndash;)","class":"math-button number-specifier negative"},a)},a.prototype.negative_slash_positive=function(a){return this.button({value:"-/+",label:"&ndash;/+","class":"math-button number-specifier negative-slash-positive"},a)},a.prototype.decimal=function(a){return this.button({value:".","class":"math-button number-specifier decimal"},a)},a.prototype.addition=function(a){return this.button({value:"+","class":"math-button operation"},a)},a.prototype.multiplication=function(a){return this.button({value:"*",label:"&times;","class":"math-button operation"},a)},a.prototype.division=function(a){return this.button({value:"/",label:"&divide;","class":"math-button operation"},a)},a.prototype.subtraction=function(a){return this.button({value:"-",label:"&ndash;","class":"math-button operation"},a)},a.prototype.subtraction=function(a){return this.button({value:"-",label:"&ndash;","class":"math-button operation"},a)},a.prototype.equals=function(a){return this.button({value:"=","class":"math-button operation equal"},a)},a.prototype.clear=function(a){return this.button({value:"clear","class":"math-button other clear"},a)},a.prototype.del=function(a){return this.button({value:"del","class":"math-button other del"},a)},a.prototype.square=function(a){return this.button({value:"square",label:""+b("x")+"<sup>2</sup>","class":"math-button other square"},a)},a.prototype.exponent=function(a){var c,d;return c=a.base||b("x"),d=a.power||b("y"),this.button({value:"exponent",label:""+c+"<sup>"+d+"</sup>","class":"math-button other exponent"},a)},a.prototype.root=function(a){var c,d;return c=a.degree?"<div class='degree'>"+a.degree+"</div>":"",d=a.radicand?"<div class='radicand'>"+a.radicand+"</div>":"<div class='radicand'>"+b("x")+"</div>",this.button({value:"root",label:""+c+"\n"+d+"\n<div class='radix'>&radic;</div>\n<div class='vinculum'>&#8212;</div>","class":"math-button other root"},a)},a.prototype.fraction=function(a){return this.button({value:"fraction",label:"<div class='numerator'>a</div>\n<div class='vinculum'>&#8212;</div>\n<div class='denominator'>b</div>","class":"math-button other fraction"},a)},a.prototype.lparen=function(a){return this.button({value:"(","class":"math-button parentheses other"},a)},a.prototype.rparen=function(a){return this.button({value:")","class":"math-button parentheses other"},a)},a.prototype.pi=function(a){return this.button({value:"pi",label:"&pi;","class":"math-button pi other"},a)},a.prototype.variables=function(a){var b,c;return c=function(){var c,d,e,f,g=this;for(e=a.variables,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(function(b){return g.button({value:""+b.name,"class":"math-button variable other",variable:b},a)}(b));return f}.call(this)},a.prototype.fn=function(a){var b;return b=a.name?"function["+a.name+"]":"function",this.button({value:b,label:"&fnof;","class":"math-button other function"},a)},a.prototype.button=function(a,b){return this.ui_elements.button_builder.build(_.extend({},a,this.opts,b||{}))},a}(),c.widgets.ButtonBuilder=c.class_mixer(a)}).call(this)},{}],18:[function(){(function(){var a,b,c,d;d=thinkthroughmath,a=function(){function a(){}return a.prototype.initialize=function(a){this.opts=null!=a?a:{}},a.prototype.render=function(a){var b;return null==a&&(a={}),a=_.extend({},this.opts,a),b=$("<button class='"+a["class"]+"' value='"+a.value+"'>"+(a.label||a.value)+"</button>"),b.on("click",function(){return a.click&&a.click(a)}),a.element.append(b)},a}(),d.class_mixer(a),b=function(){function a(){}return a.prototype.initialize=function(a){this.opts=null!=a?a:{}},a.prototype.render=function(a){return null==a&&(a={}),a=_.extend({},this.opts,a),this.figure=$("<figure class='math-display "+a["class"]+"'>"+(a["default"]||"0")+"</figure>"),a.element.append(this.figure),this.figure},a.prototype.update=function(a){return this.figure.html(a)},a}(),d.class_mixer(b),c=function(){function c(){}return c.prototype.button_builder=a,c.prototype.math_display_builder=b,c}(),d.widgets.UIElements=d.class_mixer(c)}).call(this)},{}],19:[function(a,b,c){(function(){var a=this,d=a._,e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.push,j=f.slice,k=f.concat,l=g.toString,m=g.hasOwnProperty,n=f.forEach,o=f.map,p=f.reduce,q=f.reduceRight,r=f.filter,s=f.every,t=f.some,u=f.indexOf,v=f.lastIndexOf,w=Array.isArray,x=Object.keys,y=h.bind,z=function(a){return a instanceof z?a:this instanceof z?(this._wrapped=a,void 0):new z(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=z),c._=z):a._=z,z.VERSION="1.5.2";var A=z.each=z.forEach=function(a,b,c){if(null!=a)if(n&&a.forEach===n)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)===e)return}else for(var g=z.keys(a),d=0,f=g.length;f>d;d++)if(b.call(c,a[g[d]],g[d],a)===e)return};z.map=z.collect=function(a,b,c){var d=[];return null==a?d:o&&a.map===o?a.map(b,c):(A(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var B="Reduce of empty array with no initial value";z.reduce=z.foldl=z.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),p&&a.reduce===p)return d&&(b=z.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(A(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(B);return c},z.reduceRight=z.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),q&&a.reduceRight===q)return d&&(b=z.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=z.keys(a);f=g.length}if(A(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(B);return c},z.find=z.detect=function(a,b,c){var d;return C(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},z.filter=z.select=function(a,b,c){var d=[];return null==a?d:r&&a.filter===r?a.filter(b,c):(A(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},z.reject=function(a,b,c){return z.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},z.every=z.all=function(a,b,c){b||(b=z.identity);var d=!0;return null==a?d:s&&a.every===s?a.every(b,c):(A(a,function(a,f,g){return(d=d&&b.call(c,a,f,g))?void 0:e}),!!d)};var C=z.some=z.any=function(a,b,c){b||(b=z.identity);var d=!1;return null==a?d:t&&a.some===t?a.some(b,c):(A(a,function(a,f,g){return d||(d=b.call(c,a,f,g))?e:void 0}),!!d)};z.contains=z.include=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):C(a,function(a){return a===b})},z.invoke=function(a,b){var c=j.call(arguments,2),d=z.isFunction(b);return z.map(a,function(a){return(d?b:a[b]).apply(a,c)})},z.pluck=function(a,b){return z.map(a,function(a){return a[b]})},z.where=function(a,b,c){return z.isEmpty(b)?c?void 0:[]:z[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},z.findWhere=function(a,b){return z.where(a,b,!0)},z.max=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&z.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return A(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},z.min=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&z.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return A(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},z.shuffle=function(a){var b,c=0,d=[];return A(a,function(a){b=z.random(c++),d[c-1]=d[b],d[b]=a}),d},z.sample=function(a,b,c){return arguments.length<2||c?a[z.random(a.length-1)]:z.shuffle(a).slice(0,Math.max(0,b))};var D=function(a){return z.isFunction(a)?a:function(b){return b[a]}};z.sortBy=function(a,b,c){var d=D(b);return z.pluck(z.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={},f=null==c?z.identity:D(c);return A(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};z.groupBy=E(function(a,b,c){(z.has(a,b)?a[b]:a[b]=[]).push(c)}),z.indexBy=E(function(a,b,c){a[b]=c}),z.countBy=E(function(a,b){z.has(a,b)?a[b]++:a[b]=1}),z.sortedIndex=function(a,b,c,d){c=null==c?z.identity:D(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},z.toArray=function(a){return a?z.isArray(a)?j.call(a):a.length===+a.length?z.map(a,z.identity):z.values(a):[]},z.size=function(a){return null==a?0:a.length===+a.length?a.length:z.keys(a).length},z.first=z.head=z.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:j.call(a,0,b)},z.initial=function(a,b,c){return j.call(a,0,a.length-(null==b||c?1:b))},z.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:j.call(a,Math.max(a.length-b,0))},z.rest=z.tail=z.drop=function(a,b,c){return j.call(a,null==b||c?1:b)},z.compact=function(a){return z.filter(a,z.identity)};var F=function(a,b,c){return b&&z.every(a,z.isArray)?k.apply(c,a):(A(a,function(a){z.isArray(a)||z.isArguments(a)?b?i.apply(c,a):F(a,b,c):c.push(a)}),c)};z.flatten=function(a,b){return F(a,b,[])},z.without=function(a){return z.difference(a,j.call(arguments,1))},z.uniq=z.unique=function(a,b,c,d){z.isFunction(b)&&(d=c,c=b,b=!1);var e=c?z.map(a,c,d):a,f=[],g=[];return A(e,function(c,d){(b?d&&g[g.length-1]===c:z.contains(g,c))||(g.push(c),f.push(a[d]))}),f},z.union=function(){return z.uniq(z.flatten(arguments,!0))},z.intersection=function(a){var b=j.call(arguments,1);return z.filter(z.uniq(a),function(a){return z.every(b,function(b){return z.indexOf(b,a)>=0})})},z.difference=function(a){var b=k.apply(f,j.call(arguments,1));return z.filter(a,function(a){return!z.contains(b,a)})},z.zip=function(){for(var a=z.max(z.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=z.pluck(arguments,""+c);return b},z.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},z.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=z.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(u&&a.indexOf===u)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},z.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(v&&a.lastIndexOf===v)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},z.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var G=function(){};z.bind=function(a,b){var c,d;if(y&&a.bind===y)return y.apply(a,j.call(arguments,1));if(!z.isFunction(a))throw new TypeError;return c=j.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(j.call(arguments)));G.prototype=a.prototype;var e=new G;G.prototype=null;var f=a.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}},z.partial=function(a){var b=j.call(arguments,1);return function(){return a.apply(this,b.concat(j.call(arguments)))}},z.bindAll=function(a){var b=j.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return A(b,function(b){a[b]=z.bind(a[b],a)}),a},z.memoize=function(a,b){var c={};return b||(b=z.identity),function(){var d=b.apply(this,arguments);return z.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},z.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},z.defer=function(a){return z.delay.apply(z,[a,1].concat(j.call(arguments,1)))},z.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},z.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},z.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},z.wrap=function(a,b){return function(){var c=[a];return i.apply(c,arguments),b.apply(this,c)}},z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},z.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},z.keys=x||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)z.has(a,c)&&b.push(c);return b},z.values=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},z.pairs=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},z.invert=function(a){for(var b={},c=z.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},z.functions=z.methods=function(a){var b=[];for(var c in a)z.isFunction(a[c])&&b.push(c);return b.sort()},z.extend=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},z.pick=function(a){var b={},c=k.apply(f,j.call(arguments,1));return A(c,function(c){c in a&&(b[c]=a[c])}),b},z.omit=function(a){var b={},c=k.apply(f,j.call(arguments,1));for(var d in a)z.contains(c,d)||(b[d]=a[d]);return b},z.defaults=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},z.clone=function(a){return z.isObject(a)?z.isArray(a)?a.slice():z.extend({},a):a},z.tap=function(a,b){return b(a),a};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof z&&(a=a._wrapped),b instanceof z&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(z.isFunction(g)&&g instanceof g&&z.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,j=!0;if("[object Array]"==e){if(i=a.length,j=i==b.length)for(;i--&&(j=H(a[i],b[i],c,d)););}else{for(var k in a)if(z.has(a,k)&&(i++,!(j=z.has(b,k)&&H(a[k],b[k],c,d))))break;if(j){for(k in b)if(z.has(b,k)&&!i--)break;j=!i}}return c.pop(),d.pop(),j};z.isEqual=function(a,b){return H(a,b,[],[])},z.isEmpty=function(a){if(null==a)return!0;if(z.isArray(a)||z.isString(a))return 0===a.length;for(var b in a)if(z.has(a,b))return!1;return!0},z.isElement=function(a){return!(!a||1!==a.nodeType)},z.isArray=w||function(a){return"[object Array]"==l.call(a)},z.isObject=function(a){return a===Object(a)},A(["Arguments","Function","String","Number","Date","RegExp"],function(a){z["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}}),z.isArguments(arguments)||(z.isArguments=function(a){return!(!a||!z.has(a,"callee"))}),"function"!=typeof/./&&(z.isFunction=function(a){return"function"==typeof a}),z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},z.isNaN=function(a){return z.isNumber(a)&&a!=+a},z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==l.call(a)},z.isNull=function(a){return null===a},z.isUndefined=function(a){return void 0===a},z.has=function(a,b){return m.call(a,b)},z.noConflict=function(){return a._=d,this},z.identity=function(a){return a},z.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},z.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=z.invert(I.escape);var J={escape:new RegExp("["+z.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+z.keys(I.unescape).join("|")+")","g")};z.each(["escape","unescape"],function(a){z[a]=function(b){return null==b?"":(""+b).replace(J[a],function(b){return I[a][b]})}}),z.result=function(a,b){if(null==a)return void 0;var c=a[b];return z.isFunction(c)?c.call(a):c},z.mixin=function(a){A(z.functions(a),function(b){var c=z[b]=a[b];z.prototype[b]=function(){var a=[this._wrapped];return i.apply(a,arguments),O.call(this,c.apply(z,a))}})};var K=0;z.uniqueId=function(a){var b=++K+"";return a?a+b:b},z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;z.template=function(a,b,c){var d;c=z.defaults({},c,z.templateSettings);var e=new RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||L).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(N,function(a){return"\\"+M[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,z);var i=function(a){return d.call(this,a,z)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},z.chain=function(a){return z(a).chain()};var O=function(a){return this._chain?z(a).chain():a};z.mixin(z),A(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=f[a];z.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],O.call(this,c)}}),A(["concat","join","slice"],function(a){var b=f[a];z.prototype[a]=function(){return O.call(this,b.apply(this._wrapped,arguments))}}),z.extend(z.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}]},{},[1]);